<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta property="og:type" content="article">
    <meta property="og:title" content="Preprocessing with Scikit-learn Pipelines (2/3)">
    <meta property="og:url"
        content="https://fabianhruby.github.io/posts/2024/preprocessing/preprocessing-pipelines-part2.html">
    <meta property="og:image"
        content="https://fabianhruby.github.io/assets/img/posts/2024/preprocessing/preprocessing-with-scikit-learn-pipelines-part2.jpg">
    <meta property="og:description"
        content="This article explores data preprocessing in machine learning, specifically focusing on scikit-learn pipelines. It highlights the importance of clean data for successful model development. The article explores common data issues including missing values and inconsistent scales, and how scikit-learn pipelines can address these issues. It also introduces the concept of transformers and how they can be used within pipelines.">
    <meta property="article:author" content="Fabian Hruby">
    <meta property="article:tag" content="data science">
    <meta property="article:tag" content="scikit-learn">
    <meta property="article:tag" content="sklearn">
    <meta property="article:tag" content="data preprocessing">
    <meta property="article:tag" content="machine learning">
    <title>Preprocessing with scikit-learn Pipelines | Part 1 - Byte-Sized Insights</title>
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico" />
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <!-- Google fonts-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Fira+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="/css/styles.css" rel="stylesheet" />
    <link href="/css/prism-atom-dark.css" rel="stylesheet" />
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
        MathJax.Hub.Config({messageStyle: 'none',tex2jax: {preview: 'none'}});
      </script>
    <script type="text/javascript" charset="utf-8" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,
    https://vincenttam.github.io/javascripts/MathJaxLocal.js"></script>

</head>

<body>
    <!-- Navigation-->
    <nav class="navbar navbar-expand-lg navbar-light" id="mainNav">
        <div class="container px-4 px-lg-5">
            <a class="navbar-brand" href="/index.html">Byte-Sized Insights</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive"
                aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                Menu
                <i class="fas fa-bars"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ms-auto py-4 py-lg-0">
                    <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="/index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="/about.html">About</a></li>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- Page Header-->
    <header class="masthead"
        style="background-image: url('/assets/img/posts/2024/preprocessing/preprocessing-with-scikit-learn-pipelines-part2.jpg')">
        <div class="container position-relative px-4 px-lg-5">
            <div class="row gx-4 gx-lg-5 justify-content-center">
                <div class="col-md-6 col-lg-8 col-xl-8">
                    <div class="post-heading">
                        <h1>Preprocessing with Scikit-learn Pipelines (2/3)</h1>
                        <h2 class="subheading">Elevate your Preprocessing with Custom Transformers</h2>
                        <span class="meta">
                            Posted by Fabian Hruby on XXX XX, 2024
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- Post Content-->
    <article class="mb-4">
        <div class="container px-4 px-lg-5">
            <div class="row gx-4 gx-lg-6 justify-content-center">
                <div class="col-md-10 col-lg-10 col-xl-8">
                    <h2>Introduction</h2>
                    <p>Building on our understanding of data preprocessing with Scikit-learn <incode>Pipeline</incode>
                        from the <a href="/posts/2024/preprocessing/preprocessing-pipelines-part1.html">first part of
                            this
                            series</a>, let's explore how to transform categorical data. This part goes beyond basic
                        techniques, introducing custom transformers for tailored data cleaning.</p>
                    <p>Our introductory example was very simple in this respect, as we only had to deal with missing
                        numerical values. With categorical variables, things are a bit different – especially if we
                        not only want to replace missing values, but also want to clean up messy data, for example.</p>
                    <p>In this part of the series, we will to look at transforming categorical data using standard
                        techniques such as one-hot encoding, but we will also introduce custom transformers that allow
                        us to to define custom preprocessing functions to meet specific needs based on the data
                        available.
                    </p>
                    <h2>Setting the goal of your next transformations</h2>
                    <p>Speaking of data, let's take a look at our data after applying the transformations from part 1:
                        <br><br>
                        <img class="img-fluid"
                            src="/assets/img/posts/2024/preprocessing/preprocessing-with-scikit-learn-pipelines-part2-data.png">
                        <br><br>
                        Our columns <incode>age</incode>, <incode>experience_in_years</incode> and <incode>
                            salary_in_dollar</incode> look well prepared after we imputed missing values and scaled them
                        with scikit-learns <incode>MinMaxScaler</incode>.
                        <br>But what about values highlighted in yellow? Imagine you want to feed them as features into
                        a neural network which can only handle numerical values?
                    </p>
                    <p>Models such as neural networks can only work with numerical data, so it is quite obvious what we
                        need to do: we need to convert our categorical data represented as strings into numbers – at
                        least the values in the <incode>job_title</incode> and city columns. Although the values in the
                        <incode>postal_codes</incode> column are already converted to integers and we do not need to
                        change their datatype in principle, they do represent categories after all. Therefore, we want
                        to create bins (=groups) and assign each postal code to one of these created bins. Applying
                        <a href="https://en.wikipedia.org/wiki/One-hot#Machine_learning_and_statistics">one-hot
                            encoding</a> to the <incode>postal_code</incode> column with unique postal codes would lead
                        to a very high-dimensional feature space. Binning postal codes into groups and then applying
                        one-hot encoding to these groups will significantly reduce the number of dimensions while still
                        capturing meaningful information.
                    </p>
                    <p>But before we start converting the string values to numbers, we need to think about the
                        highlighted values in the <incode>job_title</incode> column, as they contain unwanted special
                        characters. You might think that they can be ignored as we are going to convert them to numeric
                        values anyway, but this is not the case.
                        <br>Since the job titles have no intrinsic order that we want to preserve when converting them
                        to numbers, we will use one-hot encoding to do the job.
                    </p>
                    <pre>
<code class="language-python">"""CODE"""</code>
</pre>
                </div>
            </div>
        </div>
    </article>
    <!-- Footer-->
    <footer class="border-top">
        <div class="container px-4 px-lg-5">
            <div class="row gx-4 gx-lg-5 justify-content-center">
                <div class="col-md-10 col-lg-8 col-xl-7">
                    <ul class="list-inline text-center">
                        <li class="list-inline-item">
                            <a class="logo" href="https://www.linkedin.com/in/fabian-hruby-36b932100/">
                                <span class="fa-stack fa-lg">
                                    <i class="fas fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li class="list-inline-item">
                            <a class="logo" href="https://github.com/fabianhruby">
                                <span class="fa-stack fa-lg">
                                    <i class="fas fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    </ul>
                    <div class="small text-center text-muted fst-italic">Copyright &copy; Byte-Sized Insights 2024
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- Bootstrap core JS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Core theme JS-->
    <script src="/js/scripts.js"></script>
    <script src="/js/prism.js"></script>
</body>

</html>
