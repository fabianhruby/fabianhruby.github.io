<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Preprocessing with scikit-learn Pipelines | Part 1 - Byte-Sized Insights</title>
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico" />
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <!-- Google fonts-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Fira+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="/css/styles.css" rel="stylesheet" />
    <link href="/css/prism-atom-dark.css" rel="stylesheet" />
</head>

<body>
    <!-- Navigation-->
    <nav class="navbar navbar-expand-lg navbar-light" id="mainNav">
        <div class="container px-4 px-lg-5">
            <a class="navbar-brand" href="/index.html">Byte-Sized Insights</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive"
                aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                Menu
                <i class="fas fa-bars"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ms-auto py-4 py-lg-0">
                    <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="/index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="/about.html">About</a></li>a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- Page Header-->
    <header class="masthead"
        style="background-image: url('/assets/img/posts/2024/preprocessing-with-scikit-learn-pipelines-part1.jpg')">
        <div class="container position-relative px-4 px-lg-5">
            <div class="row gx-4 gx-lg-5 justify-content-center">
                <div class="col-md-6 col-lg-8 col-xl-8">
                    <div class="post-heading">
                        <h1>Preprocessing with scikit-learn Pipelines (1/3)</h1>
                        <h2 class="subheading">Motivation and Standard Transformers</h2>
                        <span class="meta">
                            Posted by Fabian Hruby on April 20, 2024
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- Post Content-->
    <article class="mb-4">
        <div class="container px-4 px-lg-5">
            <div class="row gx-4 gx-lg-6 justify-content-center">
                <div class="col-md-10 col-lg-10 col-xl-8">
                    <h2>Introduction</h2>
                    <p>You have probably come across the phrase "garbage in, garbage out" when reading articles or books
                        on machine learning. That's where data preprocessing comes in. It's a fundamental step in the
                        machine learning lifecycle and has a significant impact on model performance and efficiency.</p>
                    <p>In this three-part series, we'll take a look at the world of data preprocessing using
                        scikit-learn
                        pipelines.
                        <strong>Part 1</strong> will explore the "why" and "how" of preprocessing, focusing on standard
                        transformers and their limitations.
                        <strong>Part 2</strong> will explore more advanced techniques for handling categorical data and
                        building custom transformers, while <strong>part 3</strong> will introduce scikit-learn's
                        ColumnTransformer, which is suitable for applying transformations to heterogeneous datasets
                        (datasets with different data types).
                    </p>
                    <h2>Why do we even want to preprocess our data?</h2>
                    <p>Clean and properly scaled data is critical to successfully training machine learning models - and
                        here's why:</p>
                    <p>
                    <ul>
                        <li>
                            <h3> Missing or incorrect Values</h3>
                            Data collection isn't always perfect and you may come across missing or incorrect values.
                            These missing and incorrect values can confuse your model and lead to inaccurate
                            predictions. Preprocessing techniques such as imputation (filling in missing values) or
                            deletion ensure that your data is valid and ready for model building.
                        </li>
                        </p>
                        <p>
                            <li>
                                <h3>Different Scales</h3>
                                Imagine that one feature in your data measures income in dollars (from 0 to millions)
                                and another measures age in years (0 to 100). If you feed this directly into a model,
                                the income feature will overwhelm the age feature due to its larger scale. This can
                                cause the model to prioritise income over age, even though age may be a more important
                                factor for your prediction. Preprocessing techniques such as scaling or normalization
                                address this by putting all features on a similar scale.
                            </li>
                        </p>
                    </ul>
                    By handling missing values and ensuring consistent scales, preprocessing helps your machine learning
                    model focus on the actual relationships within your data. This leads to cleaner, more accurate and
                    more interpretable results.

                    <p>In addition to these, there are other reasons to preprocess data, such as:
                    <ul>
                        <li>
                            <h3>Encoding Categorical Features</h3>
                            Many models can't understand text labels directly. Preprocessing techniques such as one-hot
                            encoding transform categorical features (such as "red", "blue", "green") into numerical
                            representations that the model can work with.
                        </li>
                        </p>
                        <p>
                            <li>
                                <h3>Handling Outliers</h3>
                                Extreme outliers can skew your model's predictions. Preprocessing techniques such as
                                capping address these outliers without discarding valuable data points.
                            </li>
                    </ul>
                    </p>
                    <h2>Enter the Pipeline: A Streamlined Approach with scikit-learn</h2>
                    <p>

                        Sklearn describes a pipeline as followed:<br>
                    <blockquote class="blockquote">
                        A sequence of data transformers with an optional final predictor.
                        <br><br>
                        Pipeline allows you to sequentially apply a list of transformers to
                        preprocess the
                        data
                        and,
                        if desired, conclude the sequence with a final predictor for predictive modeling.
                        <br><br>
                        – <cite><a
                                href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html">Sklearn
                                Pipeline</a></cite>
                    </blockquote>
                    In order to understand how a pipeline works and how you can utilize it, we will use a very simple
                    script. I'll explain the different parts step by step to give you a good understanding of what's
                    going on.
                    <br><br>
                    But first, let's have a quick look at the data we will be working with in this preprocessing series:
                    <br><br>
                    <img class="img-fluid"
                        src="/assets/img/posts/2024/preprocessing-with-scikit-learn-pipelines-part1-data.png">
                    <br>
                    </p>
                    <p>
                        In this post, we will focus on the erroneous data in the yellow rectangles. The data points
                        highlighted in red are the ones we will be looking at in part two.
                        <br><br>
                        As you can see, we are only focusing on the numerical columns. The problem with these data
                        points is obvious: we have missing data, but we will find a way to fix this – with some simple
                        preprocessing
                        pipeline from scikit-learn's <incode>Pipeline</incode> class.
                    </p>
                    <pre>
<code class="language-python">"""Script for preprocessing data"""

import pandas as pd
from sklearn.impute import SimpleImputer
from sklearn.pipeline import Pipeline
from sklearn.preprocessing import MinMaxScaler

# Path to our raw data
DATA_PATH = "data/data.xlsx"

# Reading in data and converting the postal_code column as an integer
raw_data = pd.read_excel(DATA_PATH, converters={"postal_code": int})

# Selecting the columns in which missing values should be imputed
cols_to_impute = ["age", "experience_in_years", "salary_in_dollar"]

# Creating our Pipeline object with a SimpleImputer and MinMaxScaler from sklearn
pipeline = Pipeline([
    ("MeanImputer", SimpleImputer(strategy="mean")),
    ("MinMaxScaler", MinMaxScaler()),
])

# Coping our raw_data and imputing missing values with the column's mean
imputed_data = raw_data.copy()
imputed_data[cols_to_impute] = pipeline.fit_transform(raw_data[cols_to_impute])
</code>
</pre>


                </div>
            </div>
        </div>
    </article>
    <!-- Footer-->
    <footer class="border-top">
        <div class="container px-4 px-lg-5">
            <div class="row gx-4 gx-lg-5 justify-content-center">
                <div class="col-md-10 col-lg-8 col-xl-7">
                    <ul class="list-inline text-center">
                        <li class="list-inline-item">
                            <a href="https://www.linkedin.com/in/fabian-hruby-36b932100/">
                                <span class="fa-stack fa-lg">
                                    <i class="fas fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li class="list-inline-item">
                            <a href="https://github.com/fabianhruby">
                                <span class="fa-stack fa-lg">
                                    <i class="fas fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    </ul>
                    <div class="small text-center text-muted fst-italic">Copyright &copy; Byte-Sized Insights 2024
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- Bootstrap core JS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Core theme JS-->
    <script src="/js/scripts.js"></script>
    <script src="/js/prism.js"></script>
</body>

</html>